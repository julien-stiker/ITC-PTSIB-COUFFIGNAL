
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TP9 : Plus courts chemins &#8212; Les TP d informatique en PTSI-B</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="TP8 : Applications des parcours de graphe" href="TP8.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Les TP d informatique en PTSI-B</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Les TP d’informatique en PTSI-B au lycée Coufignal
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="TP1.html">
   TP1 : La reprise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP2.html">
   TP2 : Des modules, des tests et un peu de complexité
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP4.html">
   TP4 : Récursivité
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP6.html">
   TP6 : Algorithmes gloutons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP8.html">
   TP8 : Applications des parcours de graphe
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   TP9 : Plus courts chemins
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/julien-stiker/TP-PTSIB-21-22"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/julien-stiker/TP-PTSIB-21-22/issues/new?title=Issue%20on%20page%20%2FTP9.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/TP9.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variations-autour-de-dijkstra">
   Variations autour de Dijkstra
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#l-algorithme-a">
   L’algorithme A*
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>TP9 : Plus courts chemins</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variations-autour-de-dijkstra">
   Variations autour de Dijkstra
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#l-algorithme-a">
   L’algorithme A*
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="tp9-plus-courts-chemins">
<h1>TP9 : Plus courts chemins<a class="headerlink" href="#tp9-plus-courts-chemins" title="Permalink to this headline">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Les objectifs du TP :</strong></p>
<ul class="simple">
<li><p>Implémenter Dijkstra avec un ensemble et une file de priorité.</p></li>
<li><p>Utiliser Dikstra.</p></li>
<li><p>Découvrir A*.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour représenter un egraphe pondéré on utilisera une structure de dictionnaire de dictionnaires.</p>
<p>Par exemple :</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>représente le graphe :</p>
<blockquote>
<div><figure class="align-center">
<a class="reference internal image-reference" href="_images/Dijkstra.png"><img alt="_images/Dijkstra.png" src="_images/Dijkstra.png" style="width: 475.5px; height: 316.5px;" /></a>
</figure>
</div></blockquote>
<p>De sorte que <code class="code docutils literal notranslate"><span class="pre">G[3]</span></code> est un dictionaire dont les clefs sont les successeurs du sommet <code class="code docutils literal notranslate"><span class="pre">3</span></code>, et tel que <code class="code docutils literal notranslate"><span class="pre">G[3][4]</span></code> est le poids de l’arrête <span class="math notranslate nohighlight">\((3, 4)\)</span>.</p>
</div>
<section id="variations-autour-de-dijkstra">
<h2>Variations autour de Dijkstra<a class="headerlink" href="#variations-autour-de-dijkstra" title="Permalink to this headline">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour rappel :</p>
<figure class="align-center">
<img alt="_images/algo_dijkstra.png" src="_images/algo_dijkstra.png" />
</figure>
</div>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra_set(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int)-&gt;tuple[list[int],list[int]]</span></code>, qui prend comme argument un graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code> pondéré sous forme de dictionnaire de dictionnaires, et un sommet <code class="code docutils literal notranslate"><span class="pre">src</span></code>, et qui retourne les listes <code class="code docutils literal notranslate"><span class="pre">dict</span></code> et <code class="code docutils literal notranslate"><span class="pre">pred</span></code>, respectivement des distances à <code class="code docutils literal notranslate"><span class="pre">src</span></code> et des prédecesseurs dans le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src`à</span> <span class="pre">un</span> <span class="pre">sommet</span> <span class="pre">:code:`s</span></code> . L’algorithme utilisera une ensemble comme décrit dans le cours.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">min_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mini</span> <span class="o">=</span> <span class="n">inf</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mini</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">dijkstra_set</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="n">dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">inf</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>

    <span class="n">pred</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">M</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">src</span>

    <span class="k">while</span> <span class="n">s</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">M</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                <span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">min_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist</span><span class="p">,</span> <span class="n">pred</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Ecrire une seconde fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int)-&gt;tuple[dict,dict]</span></code>, qui prend comme argument un graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code> sous forme de dictionnaire de dictionnaires, et un sommet <code class="code docutils literal notranslate"><span class="pre">src</span></code>, et qui retourne les dictionnaires <code class="code docutils literal notranslate"><span class="pre">dist</span></code> et <code class="code docutils literal notranslate"><span class="pre">pred</span></code>, respectivement des distances à <code class="code docutils literal notranslate"><span class="pre">src</span></code> et des prédecesseurs dans le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à un sommet <code class="code docutils literal notranslate"><span class="pre">s</span></code>. L’algorithme utilisera un file de priorité comme décrit dans le cours. Vous utiliserez le module <code class="code docutils literal notranslate"><span class="pre">heap</span></code> fournit avec le TP.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">heap</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">dijkstra_heap</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span>
        <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">pred</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">M</span> <span class="o">=</span> <span class="n">Heap</span><span class="p">([])</span>

    <span class="n">M</span><span class="o">.</span><span class="n">push</span><span class="p">((</span><span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">],</span><span class="n">src</span><span class="p">))</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                <span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
                <span class="n">M</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">))</span>


    <span class="k">return</span> <span class="n">pred</span><span class="p">,</span> <span class="n">dist</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Utiliser la fonction <code class="code docutils literal notranslate"><span class="pre">alea_directed_graphe</span></code>, qui se trouve dans le module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code> pour générer des graphes orientés et pondérés de tailles <span class="math notranslate nohighlight">\(100*2^k\)</span> pour <span class="math notranslate nohighlight">\(1\leq k\leq 7\)</span>, et comparer les temps d’exécution des deux fontions <code class="code docutils literal notranslate"><span class="pre">dijkstra_set</span></code> et <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap</span></code>. Que constatez-vous ?</p>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">build_path(pred:</span> <span class="pre">dict,</span> <span class="pre">src,</span> <span class="pre">dst):-&gt;list</span></code> qui retourne la liste des sommets qui constituent le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code>.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_path</span><span class="p">(</span><span class="n">pred</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">dst</span>

    <span class="k">while</span> <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span>
    <span class="k">return</span> <span class="n">path</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Modifier le code la fonction <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap</span></code>, pour écrire une nouvelle fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int)-&gt;float,</span> <span class="pre">list[int]</span></code>, qui retourne le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code> dans le graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code>, s’il existe, ainsi que sa longueur, et <code class="code docutils literal notranslate"><span class="pre">None</span></code> sinon. Vous veuillerez à arrêter l’agorithme dès que la destination <code class="code docutils literal notranslate"><span class="pre">dst</span></code> est atteinte.</p>
<p><strong>Exercice (bonus) :</strong> Ecrice une fonction <code class="code docutils literal notranslate"><span class="pre">round_trip(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int)-&gt;list[int]</span></code> qui retourne, s’il existe, le plus court chemin aller-retour de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code> qui au retour ne passe pas par les mêmes sommets qu’à l’aller.</p>
</section>
<section id="l-algorithme-a">
<h2>L’algorithme A*<a class="headerlink" href="#l-algorithme-a" title="Permalink to this headline">#</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>L’algorithme A* est un algorithme de recherche de chemin dans un graphe entre un noeud initial <code class="code docutils literal notranslate"><span class="pre">src</span></code> et un noeud final <code class="code docutils literal notranslate"><span class="pre">dst</span></code>. Il utilise une évaluation heuristique sur chaque noeud pour estimer le meilleur chemin y passant, et visite ensuite les noeuds par ordre de cette évaluation heuristique. Vous trouverez de nombreuses informations <a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_A*">ici</a>.</p>
<p>Imaginons que le graphe que l’on va parcourir représente les cases d’un plateau sur lequel on souhaite se déplacer.</p>
<figure class="align-center">
<img alt="_images/grille.png" src="_images/grille.png" />
</figure>
<p>Si nous souhaitons trouver le chemin le plus court du sommet <code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> au sommet <code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>. L’application de l’algorithme de Dijkstra, va visiter les neuf points du sommets du graphe, en procédant à un parcours largeur. Notre intuition est que des trois sommets <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code> et <code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>, nous devrions dès le début privilégier celui qui nous rapproche le plus de la destination, soit le <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code>.</p>
<figure class="align-center">
<img alt="_images/grille3.png" src="_images/grille3.png" />
</figure>
<p>Pour déterminer quelle est la bonne direction on peut utiliser comme heuristique <code class="code docutils literal notranslate"><span class="pre">h</span></code> la distance entre le noeud étudié et la déstination, quelque soit cette distance (distance euclidienne, distance de Manhattan, etc…). Dans ce cas, la priorité avec laquelle on doit traiter un sommet est donnée par la minimisation de la quantité <code class="code docutils literal notranslate"><span class="pre">dist[s]+h(s,dst)</span></code>, où <code class="code docutils literal notranslate"><span class="pre">dist[s]</span></code> est la distance de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">s</span></code>, et <code class="code docutils literal notranslate"><span class="pre">h(s,</span> <span class="pre">dst)</span></code> est la distance de <code class="code docutils literal notranslate"><span class="pre">s</span></code> à la destination <code class="code docutils literal notranslate"><span class="pre">dst</span></code>.</p>
<p>Si l’heuristique est la fonction identiquement nulle, on retombe sur Dijkstra.</p>
</div>
<p><strong>Exercice :</strong> Implémenter une fonction de signature <code class="code docutils literal notranslate"><span class="pre">A_star(G:</span> <span class="pre">dict,</span> <span class="pre">h:</span> <span class="pre">callable,</span> <span class="pre">src:</span> <span class="pre">tuple[int,int],</span> <span class="pre">dst:tuple[int,int])-&gt;list[int],int,</span> <span class="pre">int</span></code>, qui prend comme argument un graphe, une heuristique, un sommet source et un sommet destination et qui retourne le dictionnaire <code class="code docutils literal notranslate"><span class="pre">pred</span></code> des prédecesseurs dans le plus court chemin trouvé entre <code class="code docutils literal notranslate"><span class="pre">src</span></code> et <code class="code docutils literal notranslate"><span class="pre">dst</span></code>, s’il existe. Ainsi que le nombre de sommets visités lors de la recherche du chamin, et le nombre d’itération de la boucle principale effectuées pour déterminer le chemin.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dans le module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code>, vous trouverez les graphes qui représentent les plateaux suivants :</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="_images/plateau_L.png"><img alt="_images/plateau_L.png" src="_images/plateau_L.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Graphe G1</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="_images/plateau_B.png"><img alt="_images/plateau_B.png" src="_images/plateau_B.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Graphe G2</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="_images/plateau_2B.png"><img alt="_images/plateau_2B.png" src="_images/plateau_2B.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Graphe G3</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="_images/plateau_Lab.png"><img alt="_images/plateau_Lab.png" src="_images/plateau_Lab.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Graphe G4</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="_images/plateau_Lab2.png"><img alt="_images/plateau_Lab2.png" src="_images/plateau_Lab2.png" style="width: 493.40000000000003px; height: 478.8px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Graphe G5</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Le but de cette partie et de voir quelles solutions sont proposées par Dijkstra et par A* pour aller de la case en bas à gauche à la case en haut à droite.</p>
<p>Vous avez à votre disposition les fonctions du module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code> pour afficher les plateaux ainsi que les chemins trouvés.</p>
<p>Voici différentes propositions d’heuristiques très classqiues et moins classiques :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">h2</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">h3</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">h4</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

<span class="k">def</span> <span class="nf">h5</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<p><strong>Exercice :</strong> Pour chaqu’un des graphes de 1 à 4, tracer les chemins obtenus avec Dijkstra et A*, avec chacune des heuristiques.</p>
<p><strong>Exercice :</strong> Pour chaque graphe, noter le nombres d’itérations, le nombre de sommets visités ainsi que la longueur des chemins trouvés, par Dijkstra et A* pour chacune des heuristiques.</p>
<blockquote>
<div><ul class="simple">
<li><p>Quelle semble être la meilleure heuristique pour chacun des graphes ?</p></li>
<li><p>Une des heuristiques est-elle meilleure que toutes les autres ?</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>D’après Wikipédia :</p>
<p>Un algorithme de recherche qui garantit de toujours trouver le chemin le plus court à un but s’appelle « algorithme admissible ». Si A* utilise une heuristique qui ne surestime jamais la distance (ou plus généralement le coût) du but, A* peut être avéré admissible. Une heuristique qui rend A* admissible est elle-même appelée « heuristique admissible ».</p>
<p>On peut démontrer que A* ne considère pas plus de nœuds que tous les autres algorithmes admissibles de recherche, à condition que l’algorithme alternatif n’ait pas une évaluation heuristique plus précise. Dans ce cas, A* est l’algorithme informatique le plus efficace garantissant de trouver le chemin le plus court.</p>
<p>Le prochain exercice, va nous permettre d’observer ce qu’il se passe si l’on passe d’une heuristique admissible à une heuristique qui surestime systématiquement le coût pour atteindre la destination.</p>
</div>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">Aw_star(G:</span> <span class="pre">dict,</span> <span class="pre">h:</span> <span class="pre">callable,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int,</span> <span class="pre">w:</span> <span class="pre">float)-&gt;list[int],int,</span> <span class="pre">int</span></code>, telle que :</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">Aw_star(G,</span> <span class="pre">h,</span> <span class="pre">src,</span> <span class="pre">dst,</span> <span class="pre">w)</span> <span class="pre">=</span> <span class="pre">A_star(G,</span> <span class="pre">w</span> <span class="pre">*</span> <span class="pre">h,</span> <span class="pre">src,</span> <span class="pre">dst)</span></code></p>
</div></blockquote>
<p>L’argument <code class="code docutils literal notranslate"><span class="pre">w</span></code> agit ici comme un poids pour l’heuristique.</p>
<p>En prenant différentes valeurs pour <code class="code docutils literal notranslate"><span class="pre">w</span></code> (prendre par exemple <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(10^4\)</span> et <span class="math notranslate nohighlight">\(10^5\)</span>) observez les différents résultats obtenus avec le graphe G5 et toutes les heuristiques.</p>
<p>Comparez la longueur des chemins trouvés, observez qu’ils ne sont pas toujours optimaux mais que dans certaines situations ils ont nécessité beaucoup moins de traitement.</p>
<p>On pourra par exemple enregistrer les résultats dans un fichier csv, dont les colones seraient : [‘Fonctions’,’Poids w’,’Longueur’,’Sommets traités’,’Itérations’], puis ajouter une colone pour calculer le pourcentage que représente l’augmentation de la longueur du chemin par rapport à la longueur optimale, puis trier les données seulon le nombre de sommet traités.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "julien-stiker/TP-PTSIB-21-22",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="TP8.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">TP8 : Applications des parcours de graphe</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By J.stiker<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>