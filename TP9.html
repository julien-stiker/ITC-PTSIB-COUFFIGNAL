
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TP9 : Plus courts chemins &#8212; Les TP d informatique en PTSI-B</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="TP8 : Applications des parcours de graphe" href="TP8.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Les TP d informatique en PTSI-B</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Rechercher dans ce livre ..." aria-label="Rechercher dans ce livre ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Les TP d’informatique en PTSI-B au lycée Coufignal
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="TP1.html">
   TP1 : La reprise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP2.html">
   TP2 : Des modules, des tests et un peu de complexité
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP4.html">
   TP4 : Récursivité
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP6.html">
   TP6 : Algorithmes gloutons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TP8.html">
   TP8 : Applications des parcours de graphe
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   TP9 : Plus courts chemins
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Basculer la navigation" aria-controls="site-navigation"
                title="Basculer la navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Téléchargez cette page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/TP9.rst"><button type="button"
                class="btn btn-secondary topbarbtn" title="Télécharger le fichier source" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimer au format PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/julien-stiker/TP-PTSIB-21-22"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Dépôt source"><i
                    class="fab fa-github"></i>dépôt</button></a>
        <a class="issues-button"
            href="https://github.com/julien-stiker/TP-PTSIB-21-22/issues/new?title=Issue%20on%20page%20%2FTP9.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Ouvrez un problème"><i class="fas fa-lightbulb"></i>signaler un problème</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Mode plein écran"
        title="Mode plein écran"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contenu
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variations-autour-de-dijkstra">
   Variations autour de Dijkstra
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#l-algorithme-a">
   L’algorithme A*
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="tp9-plus-courts-chemins">
<h1>TP9 : Plus courts chemins<a class="headerlink" href="#tp9-plus-courts-chemins" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Les objectifs du TP :</strong></p>
<ul class="simple">
<li><p>Implémenter Dijkstra avec un ensemble et une file de priorité.</p></li>
<li><p>Utiliser Dikstra.</p></li>
<li><p>Découvrir A*.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour représenter une graphe pondéré on utilisera une structure de dictionnaire de dictionnaires.</p>
<p>Par exemple :</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>représente le graphe :</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/Dijkstra.png"><img alt="_images/Dijkstra.png" src="_images/Dijkstra.png" style="width: 475.5px; height: 316.5px;" /></a>
</div>
</div></blockquote>
<p>De sorte que <code class="code docutils literal notranslate"><span class="pre">G[3]</span></code> est un dictionnaire dont les clefs sont les successeurs du sommet <code class="code docutils literal notranslate"><span class="pre">3</span></code>, et tel que <code class="code docutils literal notranslate"><span class="pre">G[3][4]</span></code> est le poids de l’arrête <span class="math notranslate nohighlight">\((3, 4)\)</span>.</p>
</div>
<div class="section" id="variations-autour-de-dijkstra">
<h2>Variations autour de Dijkstra<a class="headerlink" href="#variations-autour-de-dijkstra" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour rappel :</p>
<div class="figure align-center">
<img alt="_images/algo_dijkstra.png" src="_images/algo_dijkstra.png" />
</div>
</div>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra_set(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int)-&gt;tuple[list[int],list[int]]</span></code>, qui prend comme argument un graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code> pondéré sous forme de dictionnaire de dictionnaires, et un sommet <code class="code docutils literal notranslate"><span class="pre">src</span></code>, et qui retourne les listes <code class="code docutils literal notranslate"><span class="pre">dict</span></code> et <code class="code docutils literal notranslate"><span class="pre">pred</span></code>, respectivement des distances à <code class="code docutils literal notranslate"><span class="pre">src</span></code> et des prédecesseurs dans le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src`à</span> <span class="pre">un</span> <span class="pre">sommet</span> <span class="pre">:code:`s</span></code> . L’algorithme utilisera une ensemble comme décrit dans le cours.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">min_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">M</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mini</span> <span class="o">=</span> <span class="n">inf</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">M</span> <span class="ow">and</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mini</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span>

<span class="k">def</span> <span class="nf">dijkstra_set</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="n">dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">inf</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>

    <span class="n">pred</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">M</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">src</span>

    <span class="k">while</span> <span class="n">s</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">M</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                <span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">min_dist</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dist</span><span class="p">,</span> <span class="n">pred</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Ecrire une seconde fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int)-&gt;tuple[dict,dict]</span></code>, qui prend comme argument un graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code> sous forme de dictionnaire de dictionnaires, et un sommet <code class="code docutils literal notranslate"><span class="pre">src</span></code>, et qui retourne les dictionnaires <code class="code docutils literal notranslate"><span class="pre">dist</span></code> et <code class="code docutils literal notranslate"><span class="pre">pred</span></code>, respectivement des distances à <code class="code docutils literal notranslate"><span class="pre">src</span></code> et des prédecesseurs dans le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à un sommet <code class="code docutils literal notranslate"><span class="pre">s</span></code>. L’algorithme utilisera un file de priorité comme décrit dans le cours. Vous utiliserez le module <code class="code docutils literal notranslate"><span class="pre">heap</span></code> fournit avec le TP.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">heap</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">dijkstra_heap</span><span class="p">(</span><span class="n">G</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">inf</span>
        <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">pred</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">M</span> <span class="o">=</span> <span class="n">Heap</span><span class="p">([])</span>

    <span class="n">M</span><span class="o">.</span><span class="n">push</span><span class="p">((</span><span class="n">dist</span><span class="p">[</span><span class="n">src</span><span class="p">],</span><span class="n">src</span><span class="p">))</span>

    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
                <span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">G</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                <span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
                <span class="n">M</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">))</span>


    <span class="k">return</span> <span class="n">pred</span><span class="p">,</span> <span class="n">dist</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Utiliser la fonction <code class="code docutils literal notranslate"><span class="pre">alea_directed_graphe</span></code>, qui se trouve dans le module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code> pour générer des graphes orientés et pondérés de tailles <span class="math notranslate nohighlight">\(100*2^k\)</span> pour <span class="math notranslate nohighlight">\(1\leq k\leq 7\)</span>, et comparer les temps d’exécution des deux fontions <code class="code docutils literal notranslate"><span class="pre">dijkstra_set</span></code> et <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap</span></code>. Que constatez-vous ?</p>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">build_path(pred:</span> <span class="pre">dict,</span> <span class="pre">src,</span> <span class="pre">dst):-&gt;list</span></code> qui retourne la liste des sommets qui constituent le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code>.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_path</span><span class="p">(</span><span class="n">pred</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">src</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">dst</span>

    <span class="k">while</span> <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">pred</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">src</span><span class="p">]</span> <span class="o">+</span> <span class="n">path</span>
    <span class="k">return</span> <span class="n">path</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p><strong>Exercice :</strong> Modifier le code la fonction <code class="code docutils literal notranslate"><span class="pre">dijkstra_heap</span></code>, pour écrire une nouvelle fonction de signature <code class="code docutils literal notranslate"><span class="pre">dijkstra(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int)-&gt;float,</span> <span class="pre">list[int]</span></code>, qui retourne le plus court chemin de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code> dans le graphe <code class="code docutils literal notranslate"><span class="pre">G</span></code>, s’il existe, ainsi que sa longueur, et <code class="code docutils literal notranslate"><span class="pre">None</span></code> sinon. Vous veuillerez à arrêter l’agorithme dès que la destination <code class="code docutils literal notranslate"><span class="pre">dst</span></code> est atteinte.</p>
<p><strong>Exercice (bonus) :</strong> Ecrice une fonction <code class="code docutils literal notranslate"><span class="pre">round_trip(G:</span> <span class="pre">dict,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int)-&gt;list[int]</span></code> qui retourne, s’il existe, le plus court chemin aller-retour de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">dst</span></code> qui au retour ne passe pas par les mêmes sommets qu’à l’aller.</p>
</div>
<div class="section" id="l-algorithme-a">
<h2>L’algorithme A*<a class="headerlink" href="#l-algorithme-a" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>L’algorithme A* est un algorithme de recherche de chemin dans un graphe entre un noeud initial <code class="code docutils literal notranslate"><span class="pre">src</span></code> et un noeud final <code class="code docutils literal notranslate"><span class="pre">dst</span></code>. Il utilise une évaluation heuristique sur chaque noeud pour estimer le meilleur chemin y passant, et visite ensuite les noeuds par ordre de cette évaluation heuristique. Vous trouverez de nombreuses informations <a class="reference external" href="https://fr.wikipedia.org/wiki/Algorithme_A*">ici</a>.</p>
<p>Imaginons que le graphe que l’on va parcourir représente les cases d’un plateau sur lequel on souhaite se déplacer.</p>
<div class="figure align-center">
<img alt="_images/grille.png" src="_images/grille.png" />
</div>
<p>Si nous souhaitons trouver le chemin le plus court du sommet <code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code> au sommet <code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>. L’application de l’algorithme de Dijkstra, va visiter les neuf points du sommets du graphe, en procédant à un parcours largeur. Notre intuition est que des trois sommets <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">0)</span></code>, <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code> et <code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>, nous devrions dès le début privilégier celui qui nous rapproche le plus de la destination, soit le <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code>.</p>
<div class="figure align-center">
<img alt="_images/grille3.png" src="_images/grille3.png" />
</div>
<p>Pour déterminer quelle est la bonne direction on peut utiliser comme heuristique <code class="code docutils literal notranslate"><span class="pre">h</span></code> la distance entre le noeud étudié et la déstination, quelque soit cette distance (distance euclidienne, distance de Manhattan, etc…). Dans ce cas, la priorité avec laquelle on doit traiter un sommet est donnée par la minimisation de la quantité <code class="code docutils literal notranslate"><span class="pre">dist[s]+h(s,dst)</span></code>, où <code class="code docutils literal notranslate"><span class="pre">dist[s]</span></code> est la distance de <code class="code docutils literal notranslate"><span class="pre">src</span></code> à <code class="code docutils literal notranslate"><span class="pre">s</span></code>, et <code class="code docutils literal notranslate"><span class="pre">h(s,</span> <span class="pre">dst)</span></code> est la distance de <code class="code docutils literal notranslate"><span class="pre">s</span></code> à la destination <code class="code docutils literal notranslate"><span class="pre">dst</span></code>.</p>
<p>Si l’heuristique est la fonction identiquement nulle, on retombe sur Dijkstra.</p>
</div>
<p><strong>Exercice :</strong> Implémenter une fonction de signature <code class="code docutils literal notranslate"><span class="pre">A_star(G:</span> <span class="pre">dict,</span> <span class="pre">h:</span> <span class="pre">callable,</span> <span class="pre">src:</span> <span class="pre">tuple[int,int],</span> <span class="pre">dst:tuple[int,int])-&gt;list[int],int,</span> <span class="pre">int</span></code>, qui prend comme argument un graphe, une heuristique, un sommet source et un sommet destination et qui retourne le dictionnaire <code class="code docutils literal notranslate"><span class="pre">pred</span></code> des prédecesseurs dans le plus court chemin trouvé entre <code class="code docutils literal notranslate"><span class="pre">src</span></code> et <code class="code docutils literal notranslate"><span class="pre">dst</span></code>, s’il existe. Ainsi que le nombre de sommets visités lors de la recherche du chamin, et le nombre d’itération de la boucle principale effectuées pour déterminer le chemin.</p>
<div class="dropdown tip admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dans le module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code>, vous trouverez les graphes qui représentent les plateaux suivants :</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/plateau_L.png"><img alt="_images/plateau_L.png" src="_images/plateau_L.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Graphe G1</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/plateau_B.png"><img alt="_images/plateau_B.png" src="_images/plateau_B.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Graphe G2</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/plateau_2B.png"><img alt="_images/plateau_2B.png" src="_images/plateau_2B.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Graphe G3</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/plateau_Lab.png"><img alt="_images/plateau_Lab.png" src="_images/plateau_Lab.png" style="width: 493.40000000000003px; height: 479.20000000000005px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Graphe G4</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="_images/plateau_Lab2.png"><img alt="_images/plateau_Lab2.png" src="_images/plateau_Lab2.png" style="width: 493.40000000000003px; height: 478.8px;" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Graphe G5</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>Le but de cette partie et de voir quelles solutions sont proposées par Dijkstra et par A* pour aller de la case en bas à gauche à la case en haut à droite.</p>
<p>Vous avez à votre disposition les fonctions du module <code class="code docutils literal notranslate"><span class="pre">TP9</span></code> pour afficher les plateaux ainsi que les chemins trouvés.</p>
<p>Voici différentes propositions d’heuristiques très classqiues et moins classiques :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">h0</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">h1</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">h2</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">h3</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">h4</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

<span class="k">def</span> <span class="nf">h5</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

<span class="k">def</span> <span class="nf">h6</span><span class="p">(</span><span class="n">node</span> <span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<p><strong>Exercice :</strong> Pour chaqu’un des graphes de 1 à 4, tracer les chemins obtenus avec Dijkstra et A*, avec chacune des heuristiques.</p>
<p><strong>Exercice :</strong> Pour chaque graphe, noter le nombres d’itérations, le nombre de sommets visités ainsi que la longueur des chemins trouvés, par Dijkstra et A* pour chacune des heuristiques.</p>
<blockquote>
<div><ul class="simple">
<li><p>Quelle semble être la meilleure heuristique pour chacun des graphes ?</p></li>
<li><p>Une des heuristiques est-elle meilleure que toutes les autres ?</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>D’après Wikipédia :</p>
<p>Un algorithme de recherche qui garantit de toujours trouver le chemin le plus court à un but s’appelle « algorithme admissible ». Si A* utilise une heuristique qui ne surestime jamais la distance (ou plus généralement le coût) du but, A* peut être avéré admissible. Une heuristique qui rend A* admissible est elle-même appelée « heuristique admissible ».</p>
<p>On peut démontrer que A* ne considère pas plus de nœuds que tous les autres algorithmes admissibles de recherche, à condition que l’algorithme alternatif n’ait pas une évaluation heuristique plus précise. Dans ce cas, A* est l’algorithme informatique le plus efficace garantissant de trouver le chemin le plus court.</p>
<p>Le prochain exercice, va nous permettre d’observer ce qu’il se passe si l’on passe d’une heuristique admissible à une heuristique qui surestime systématiquement le coût pour atteindre la destination.</p>
</div>
<p><strong>Exercice :</strong> Ecrire une fonction de signature <code class="code docutils literal notranslate"><span class="pre">Aw_star(G:</span> <span class="pre">dict,</span> <span class="pre">h:</span> <span class="pre">callable,</span> <span class="pre">src:</span> <span class="pre">int,</span> <span class="pre">dst:</span> <span class="pre">int,</span> <span class="pre">w:</span> <span class="pre">float)-&gt;list[int],int,</span> <span class="pre">int</span></code>, telle que :</p>
<blockquote>
<div><p><code class="code docutils literal notranslate"><span class="pre">Aw_star(G,</span> <span class="pre">h,</span> <span class="pre">src,</span> <span class="pre">dst,</span> <span class="pre">w)</span> <span class="pre">=</span> <span class="pre">A_star(G,</span> <span class="pre">w</span> <span class="pre">*</span> <span class="pre">h,</span> <span class="pre">src,</span> <span class="pre">dst)</span></code></p>
</div></blockquote>
<p>L’argument <code class="code docutils literal notranslate"><span class="pre">w</span></code> agit ici comme un poids pour l’heuristique.</p>
<p>En prenant différentes valeurs pour <code class="code docutils literal notranslate"><span class="pre">w</span></code> (prendre par exemple <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(10^4\)</span> et <span class="math notranslate nohighlight">\(10^5\)</span>) observez les différents résultats obtenus avec le graphe G5 et toutes les heuristiques.</p>
<p>Comparez la longueur des chemins trouvés, observez qu’ils ne sont pas toujours optimaux mais que dans certaines situations ils ont nécessité beaucoup moins de traitement.</p>
<p>On pourra par exemple enregistrer les résultats dans un fichier csv, dont les colones seraient : [‘Fonctions’,’Poids w’,’Longueur’,’Sommets traités’,’Itérations’], puis ajouter une colone pour calculer le pourcentage que représente l’augmentation de la longueur du chemin par rapport à la longueur optimale, puis trier les données seulon le nombre de sommet traités.</p>
<p>Quelques exemples de résultats :</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/3_Pour_h0_et_w_=_1_et_dst_=_(49,49).png"><img alt="_images/3_Pour_h0_et_w_=_1_et_dst_=_(49,49).png" src="_images/3_Pour_h0_et_w_=_1_et_dst_=_(49,49).png" style="width: 750.0px; height: 750.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/3_Pour_h0_et_w_=_1000000_et_dst_=_(49,49).png"><img alt="_images/3_Pour_h0_et_w_=_1000000_et_dst_=_(49,49).png" src="_images/3_Pour_h0_et_w_=_1000000_et_dst_=_(49,49).png" style="width: 750.0px; height: 750.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/3_Pour_h4_et_w_=_100000_et_dst_=_(49,49).png"><img alt="_images/3_Pour_h4_et_w_=_100000_et_dst_=_(49,49).png" src="_images/3_Pour_h4_et_w_=_100000_et_dst_=_(49,49).png" style="width: 750.0px; height: 750.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/3_Pour_h6_et_w_=_100000_et_dst_=_(49,49).png"><img alt="_images/3_Pour_h6_et_w_=_100000_et_dst_=_(49,49).png" src="_images/3_Pour_h6_et_w_=_100000_et_dst_=_(49,49).png" style="width: 750.0px; height: 750.0px;" /></a>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "julien-stiker/TP-PTSIB-21-22",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="TP8.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">TP8 : Applications des parcours de graphe</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          Par J.stiker<br/>
        
            &copy; droits d'auteur 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>